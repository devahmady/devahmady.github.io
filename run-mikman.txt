#bin/bash
pkg install git php composer -y

# Clone repository mikmanv1
git clone https://github.com/devahmady/mikmanv1.git

# Install Composer dependencies for Laravel (Optional, only if you plan to use Laravel)
cd mikmanv1
composer install

# Create start-mikman script
cat >start-mikman <<EOL
#bin/bash
if pgrep "php" >/dev/null 2>&1 ; then
  killall php
fi
cd mikmanv1
php artisan sever --host=127.0.0.0:8000
EOL

# Create update-mikmanv1 script
cat >update-mikmanv1 <<EOL
#bin/bash
mkdir ~/backup-mikmanv1
cp -r ~/mikmanv1/. ~/backup-mikmanv1/
rm -rf ~/mikmanv1
git clone https://github.com/devahmady/mikmanv1.git
cp -r ~/backup-mikmanv1/.env ~/mikmanv1/
cd ~/mikmanv1
composer install
php artisan migrate
php artisan key:generate
# Tambahkan perintah lain yang diperlukan di sini
./run-mikman
EOL

# Create remove-mikmanv1 script
cat >remove-mikmanv1 <<EOL
#!/bin/bash
rm -rf mikmanv1
EOL

# Create .bashrc file
cat >>~/.bashrc <<EOL
if [ -z "\$LARAVEL_SERVER_RUNNING" ]; then
    php artisan serve &
    export LARAVEL_SERVER_RUNNING=true
fi
EOL

# Give execute permissions
chmod +x start-mikman

# Download run-mikman script
curl -O https://devahmady.github.io/run-mikman.txt

# Give execute permissions to the downloaded script
chmod +x start-mikman

# Run start-mikman script
./start-mikman
