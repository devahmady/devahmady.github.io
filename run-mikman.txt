#bin/bash
pkg install git php composer -y

# Clone repository mikmanv1
git clone https://github.com/devahmady/mikmanv1.git

# Install Composer dependencies for Laravel (Optional, only if you plan to use Laravel)
cd mikmanv1
composer install

# Create start-mikman script
cat >start-mikman <<EOL
#bin/bash
if pgrep "php" >/dev/null 2>&1 ; then
  killall php
fi
cd mikmanv1
php artisan serve
EOL

# Create update-mikmanv1 script
cat >mikmanv1 <<EOL
#bin/bash
mkdir ~/mikmanv1
cd ~/mikmanv1
composer install
php artisan optimize
php artisan key:generate
# Tambahkan perintah lain yang diperlukan di sini
./run-mikman
EOL


# Create .bashrc file
cat >>~/.bashrc <<EOL
if [ -z "\$LARAVEL_SERVER_RUNNING" ]; then
    php artisan serve &
    export LARAVEL_SERVER_RUNNING=true
fi
EOL

# Give execute permissions
curl -O https://devahmady.github.io/run-mikman.txt
chmod +x run-mikman

# Run start-mikman script
./start-mikman
