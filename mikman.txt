#!/bin/bash
pkg install git php composer -y

# Clone repository mikmanv1
git clone https://github.com/devahmady/mikman-v2.git

# Install Composer dependencies for Laravel (Optional, only if you plan to use Laravel)
cd mikman-v2
composer install --optimize-autoloader --no-dev

# Create mikman script
cat >run-mikman-v2 <<EOL
#!/bin/bash
echo "Checking for PHP processes..."
if pgrep "php" >/dev/null 2>&1 ; then
  echo "Found PHP processes, stopping..."
  killall php
fi
cd mikman-v2
cp .env.example .env
php artisan key:generate
composer install --optimize-autoloader --no-dev
php artisan optimize
echo "Starting mikman server..."
php artisan serve --host=127.0.0.1 --port=8000
EOL

# permissions
chmod +x run-mikman

# Run server start-mikman 
./run-mikman
